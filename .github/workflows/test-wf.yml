name: Test

on:
  workflow_dispatch:

# Use concurrency to enforce only 1 workflow can run at a time
concurrency:
  group: test-deploy-${{ endsWith('0', github.run_number) || endsWith('2', github.run_number) || endsWith('4', github.run_number) || endsWith('6', github.run_number) || endsWith('8', github.run_number) }}

env:
  # Name of Azure Web APP
  APP_NAME: app
  NUM: ${{ github.run_number }}
  ISEVEN: ${{ endsWith('0', github.run_number) || endsWith('2', github.run_number) || endsWith('4', github.run_number) || endsWith('6', github.run_number) || endsWith('8', github.run_number) }}

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v4

      - name: run number with offset
        run: |
          echo "GITHUB_RUN_NUMBER_WITH_OFFSET=$(($NUM + 200))" >> $GITHUB_ENV
          echo "run_number: ${{ github.run_number }}"
          echo "run_number[-1]: ${{ github.run_number[-1] }}"
          echo ${{ env.ISEVEN }}

      - name: dotnet Publish App
        run: sleep ${{ vars.VAR_SLEEPDURATION }} && echo ${{ vars.VAR_TESTMESSAGE }}
